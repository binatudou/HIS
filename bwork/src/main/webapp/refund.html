<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <link rel="stylesheet" type="text/css" href="lib/jquery-easyui-1.7.0/themes/default/easyui.css">
  <link rel="stylesheet" type="text/css" href="lib/jquery-easyui-1.7.0/themes/icon.css">
  <link rel="stylesheet" type="text/css" href="lib/jquery-easyui-1.7.0/themes/color.css">
  <script type="text/javascript" src="lib/jquery-easyui-1.7.0/jquery.min.js"></script>
  <script type="text/javascript" src="lib/jquery-easyui-1.7.0/jquery.easyui.min.js"></script>
</head>

<body>
  <div>
    <label>病历号检索：</label>
    <input class="easyui-searchbox" name="search-record" id="search-record" prompt='请输入病历号' searcher="search_record" style="width:200px" />
  </div>
  <table id="dg" title="挂号信息查询" class="easyui-datagrid" style="width:700px;height:250px" toolbar="#toolbar" pagination="true" rownumbers="true" fitColumns="true" singleSelect="true">
    <thead>
      <tr>
        <th field="RecordID">病历号</th>
        <th field="PatiName">患者姓名</th>
        <th field="ReseDate">预约日期</th>
        <th field="DocTime">午别</th>
        <th field="DeptName">挂号科室</th>
        <th field="DiagStatus">看诊状态</th>
      </tr>
    </thead>
  </table>
  <div id="toolbar">
    <a href="javascript:void(0)" class="easyui-linkbutton" iconCls="icon-remove" plain="true" onclick="refund()">退号</a>
  </div>

  <script>
    function search_record(value) {
      var r_list = getRegistration(value);
      if (r_list) {
        $("#dg").datagrid({
          data: r_list
        });
      } else {
        alert("未查询到该病历下的挂号记录");
      }
    }

    function getRegistration(value) {
      //TODO
      var r_list = new Array();
      if (value == "1") {
        r_list[0] = {
          "RecordID": "1",
          "PatiName": "病人甲",
          "ReseDate": "2020-01-01",
          "DocTime": "上午",
          "DeptName": "心血管内科",
          "DiagStatus": "未诊"
        }
      }
      return r_list;
    }

    function refund() {
      //TODO
      var row = $('#dg').datagrid('getSelected');
      if (row) {
        $.messager.confirm('确认', '是否退号？', function(r) {
          alert("退号成功");
          $("#dg").datagrid({
            data: []
          });
        });
      }
    }
  </script>
</body>

</html>